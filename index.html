<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<title>發一崇德台中道場資訊網</title>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,minimal-ui">
<meta name="theme-color" content="#7e57c2">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="manifest" href="manifest.json">
<link rel="icon" href="icons/icon-192.png">

<style>
  html, body{
    margin:0; padding:0;
    width:100%; height:100%;
    font-family:'Segoe UI', Roboto, sans-serif;
    overflow:hidden;
  }
  body{
    display:flex; justify-content:center; align-items:center;
    background: linear-gradient(135deg,#d1c4e9,#b39ddb,#9575cd,#7e57c2);
    background-size:400% 400%;
    animation:gradientBG 15s ease infinite;
  }
  @keyframes gradientBG{
    0%{background-position:0% 50%}
    50%{background-position:100% 50%}
    100%{background-position:0% 50%}
  }
  .glass-container{
    backdrop-filter: blur(15px);
    background: rgba(255,255,255,0.1);
    border-radius:25px;
    border:1px solid rgba(255,255,255,0.2);
    padding:2em;
    display:flex;
    flex-direction:column;
    align-items:center;
    text-align:center;
    color:white;
    max-width:350px;
    width:90%;
    box-shadow:0 0 40px rgba(0,0,0,0.3);
  }
  .spinner{
    width:50px;height:50px;
    border:6px solid rgba(255,255,255,0.3);
    border-top:6px solid #b39ddb;
    border-radius:50%;
    animation:spin 1s linear infinite;
    margin-bottom:1em;
  }
  @keyframes spin{to{transform:rotate(360deg)}}
  #message{font-size:1.2em;margin-bottom:1.5em;}
  .action-button{
    background: rgba(255,255,255,0.2);
    color:white;
    border:1px solid rgba(255,255,255,0.4);
    padding:12px 25px;
    border-radius:15px;
    font-size:1em;
    cursor:pointer;
    margin:0.5em 0;
    backdrop-filter: blur(5px);
    transition: all 0.3s ease;
    width:80%;
  }
  .action-button:hover{
    background: rgba(179,157,219,0.3);
    border-color: rgba(255,255,255,0.6);
    transform: scale(1.05);
  }
  #iframe-container{
    width:100%; height:100%; display:none;
  }
  #iframe-container iframe{
    width:100%; height:100%; border:none;
  }
</style>
</head>
<body>
  <div class="glass-container" id="welcome">
    <div class="spinner"></div>
    <div id="message">🔧 正在載入頁面…</div>
  </div>

  <div id="iframe-container">
    <iframe src="https://sites.google.com/view/fycd-tc/" allowfullscreen></iframe>
  </div>

<script>
const SITE_URL="https://sites.google.com/view/fycd-tc/";

function detectClient(){
  const ua = navigator.userAgent;
  return {
    isIOS: /iPhone|iPad|iPod/i.test(ua) || (ua.includes('Mac') && 'ontouchend' in document),
    isAndroid: /Android/i.test(ua),
    isChrome: /Chrome\/\d+/i.test(ua) && !ua.includes('Edg/'),
    isEdge: /Edg\/\d+/i.test(ua),
    isFirefox: /Firefox\/\d+/i.test(ua) && !ua.includes('Seamonkey'),
    isSafari: /Safari\/\d+/i.test(ua) && !/Chrome|Edg/.test(ua),
    inPWA: matchMedia('(display-mode: standalone)').matches ||
           matchMedia('(display-mode: fullscreen)').matches ||
           navigator.standalone===true
  };
}

window.addEventListener('load',()=>{
  const client = detectClient();

  if(client.inPWA){
    document.getElementById('welcome').style.display='none';
    document.getElementById('iframe-container').style.display='block';
  } else {
    const message = document.getElementById('message');
    let hint = '📲 建議安裝至桌面，享受全螢幕體驗。';
    if(client.isIOS && client.isSafari) hint='📲 在 Safari 底部「分享」→『加入主畫面』安裝。';
    else if(client.isAndroid && (client.isChrome || client.isEdge)) hint='📲 點網址列右側「安裝圖示」或選單「加入主畫面」。';
    else if(client.isFirefox) hint='🦊 Firefox 可用「⋮ 選單→安裝」或手動加入書籤。';

    message.innerHTML = `👋 歡迎安裝台中道場資訊網<br>${hint}<br>將在<strong>20 秒</strong>後自動跳轉網站<br>或點擊下方按鈕立即前往`;

    const container = document.getElementById('welcome');
    const btn = document.createElement('button');
    btn.className='action-button';
    btn.textContent='立即前往網站';
    btn.onclick = ()=> window.location.href = SITE_URL;
    container.appendChild(btn);

    setTimeout(()=>{ if(!document.hidden) window.location.href=SITE_URL; },20000);
  }
});
</script>
</body>
</html>
