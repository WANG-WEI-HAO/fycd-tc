<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>ç™¼ä¸€å´‡å¾·å°ä¸­é“å ´è³‡è¨Šç¶²</title>

  <!--â”€ Viewport èˆ‡å…¨è¢å¹• â”€-->
  <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,minimal-ui">
  <meta name="theme-color" content="#3f51b5">
  <!-- iOS å…¨è¢å¹• -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!--â”€ SEO / PWA â”€-->
  <meta name="description" content="æœ¬è³‡è¨Šç¶²å·²å°å…¥ Progressive Web Appï¼Œå¯å®‰è£è‡³æ¡Œé¢ä½¿ç”¨ã€‚">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icons/icon-192.png">

  <!--â”€ OG é è¦½ â”€-->
  <meta property="og:title"       content="ç™¼ä¸€å´‡å¾·å°ä¸­é“å ´è³‡è¨Šç¶²">
  <meta property="og:description" content="é–‹å•Ÿæœ¬è³‡è¨Šç¶²ï¼Œå¯å®‰è£è‡³æ¡Œé¢ä½¿ç”¨ï¼Œäº«å—å…¨è¢å¹•é«”é©—ã€‚">
  <meta property="og:image"       content="https://wang-wei-hao.github.io/fycd-tc/icons/icon-512.png">
  <meta property="og:url"         content="https://wang-wei-hao.github.io/fycd-tc/">

  <!--â”€ æ ¸å¿ƒæ¨£å¼ â”€-->
  <style>
    /* å…¨ç¨‹ç¦ç”¨æ©¡çš®ç­‹å›å½ˆèˆ‡ç¸®æ”¾ â”€â”€*/
    html,body{
      overscroll-behavior: none;
      touch-action: none;
      overflow:hidden;
      margin:0;padding:2em;
      font-family:sans-serif;
      background:#f0f4f8;
      display:flex;flex-direction:column;justify-content:center;align-items:center;
      min-height:100vh;box-sizing:border-box;
    }
    #message{font-size:1.2em;color:#333;margin-bottom:1em}
    .spinner{width:48px;height:48px;margin:2em auto;border:6px solid #ccc;
      border-top:6px solid #3f51b5;border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    .action-button{background:#3f51b5;color:#fff;padding:10px 20px;border:none;border-radius:5px;
      font-size:1em;cursor:pointer;margin-top:1em}
    .action-button:hover{background:#303f9f}
  </style>
</head>
<body>
  <div class="spinner"></div>
  <div id="message">ğŸ”§ æ­£åœ¨è¼‰å…¥é é¢â€¦</div>

  <script>
  /*ï¼ï¼ ç›®æ¨™ç¶²å€ ï¼ï¼*/
  const SITE_URL = "https://sites.google.com/view/fycd-tc/";

  /*ï¼ï¼ ç€è¦½å™¨ / è£ç½®åµæ¸¬ ï¼ï¼*/
  function detectClient(){
    const ua = navigator.userAgent;
    const isIOS   = /iPhone|iPad|iPod/i.test(ua)|| (ua.includes('Mac') && 'ontouchend' in document);
    const isAnd   = /Android/i.test(ua);
    const isChr   = /Chrome\/\d+/i.test(ua)&&!ua.includes('Edg/');
    const isEdg   = /Edg\/\d+/i.test(ua);
    const isFx    = /Firefox\/\d+/i.test(ua);
    const isSaf   = /Safari\/\d+/i.test(ua)&&!isChr&&!isEdg;
    return {
      isIOS,isAnd,isChr,isEdg,isFx,isSaf,
      inPWA: matchMedia('(display-mode: standalone)').matches||
             matchMedia('(display-mode: fullscreen)').matches||
             navigator.standalone===true
    };
  }

  /*ï¼ï¼ é€²å…¥ç€è¦½å™¨å…¨è¢å¹•ï¼ˆé PWA æ™‚ä¿éšªç”¨ï¼‰ï¼ï¼*/
  function requestFull(){
    const el=document.documentElement;
    const req= el.requestFullscreen||el.webkitRequestFullscreen||el.mozRequestFullScreen||el.msRequestFullscreen;
    if(req) req.call(el);
  }

  window.addEventListener('load',()=>{
    const c = detectClient();
    const msg=document.getElementById('message');
    document.addEventListener('click',requestFull,{once:true}); // é¦–æ¬¡é»æ“Šå³å˜—è©¦å…¨è¢å¹•

    /* å·²å®‰è£ â†’ ç›´æ¥è·³ */
    if(c.inPWA){
      msg.textContent='App æ­£åœ¨å•Ÿå‹•â€¦';
      window.location.href=SITE_URL;
      return;
    }

    /* å®‰è£æç¤º */
    let hint='ğŸ“² å»ºè­°å®‰è£è‡³æ¡Œé¢ï¼Œäº«å—å…¨è¢å¹•é«”é©—ã€‚';
    if(c.isIOS&&c.isSaf)      hint='ğŸ“² åœ¨ Safari åº•éƒ¨ã€Œåˆ†äº«ã€â†’ã€åŠ å…¥ä¸»ç•«é¢ã€å®‰è£ã€‚';
    else if(c.isAnd&&(c.isChr||c.isEdg))
                              hint='ğŸ“² é»ç¶²å€åˆ—å³å´ã€Œå®‰è£åœ–ç¤ºã€æˆ–é¸å–®ã€ŒåŠ å…¥ä¸»ç•«é¢ã€ã€‚';
    else if(c.isFx)           hint='ğŸ¦Š Firefox å¯ç”¨ã€Œâ‹® é¸å–®â†’å®‰è£ã€æˆ–æ‰‹å‹•åŠ å…¥æ›¸ç±¤ã€‚';

    msg.innerHTML=`ğŸ‘‹ æ­¡è¿å®‰è£å°ä¸­é“å ´è³‡è¨Šç¶²<br><br>${hint}<br>
                   å°‡åœ¨<strong>20 ç§’</strong>å¾Œè‡ªå‹•è·³è½‰ç¶²ç«™ï¼Œ<br>
                   æˆ–é»æ“Šä¸‹æ–¹æŒ‰éˆ•ç«‹å³å‰å¾€ã€‚`;
    document.querySelector('.spinner').style.display='none';

    const btn=document.createElement('button');
btn.className='action-button';
btn.textContent='ç«‹å³å‰å¾€ç¶²ç«™';
btn.onclick = () => {
  const newWin = window.open(
    SITE_URL,
    '_blank',
    'fullscreen=yes,scrollbars=yes,resizable=yes'
  );
  if (!newWin) window.location.href = SITE_URL; // é˜»æ“‹ fallback
};
document.body.appendChild(btn);

/*ï¼ï¼ iOS Safari å®‰è£æç¤ºæŒ‰éˆ• ï¼ï¼*/
if(c.isIOS && c.isSaf){
  const iosBtn = document.createElement('button');
  iosBtn.className='action-button';
  iosBtn.textContent='å®‰è£åˆ°ä¸»ç•«é¢';
  iosBtn.onclick = () => {
    alert('è«‹é»é¸ Safari åº•éƒ¨ã€Œåˆ†äº«ã€â†’ã€ŒåŠ å…¥ä¸»ç•«é¢ã€å³å¯å®‰è£');
  };
  document.body.appendChild(iosBtn);
}

/*ï¼ï¼ Chrome / Edge / Firefox å®‰è£æŒ‰éˆ• ï¼ï¼*/
let deferredPrompt;
window.addEventListener('beforeinstallprompt', e => {
  e.preventDefault();
  deferredPrompt = e;
  const installBtn = document.createElement('button');
  installBtn.textContent = 'å®‰è£å°ä¸­é“å ´è³‡è¨Šç¶²';
  installBtn.className = 'action-button';
  installBtn.onclick = async () => {
    deferredPrompt.prompt();
    const choice = await deferredPrompt.userChoice;
    console.log(`ä½¿ç”¨è€…é¸æ“‡: ${choice.outcome}`);
    deferredPrompt = null;
  };
  document.body.appendChild(installBtn);
});

  /*ï¼ï¼ è¨»å†Š SW ï¼ï¼*/
  if('serviceWorker'in navigator){
    navigator.serviceWorker.register('service-worker.js');
  }
  </script>
</body>
</html>
